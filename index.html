<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCC Reports</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js"></script>
    <script src="script.js"></script>
  </head>
  <body>
    <div class="input-container">
      <textarea id="myInput" placeholder="Enter text here..."></textarea> 
      <input id="cursorAnchor"> 
    </div>

    <script>
      $( "#myInput" ).autocomplete({
        autoFocus: true, 
        position: { of: "#cursorAnchor" }, 
        source: [ "c++", "java", "php", "coldfusion", "javascript", "asp", "ruby" ]
      });
    </script>

    <script>
      const myInput = document.getElementById('myInput');
      const cursorAnchor = document.getElementById('cursorAnchor');

      myInput.addEventListener('input', updateCursorAnchor);
      myInput.addEventListener('keyup', updateCursorAnchor); // Also update on keyup for better responsiveness
      myInput.addEventListener('click', updateCursorAnchor); // Update if cursor is moved by clicking

      function updateCursorAnchor() {
        const cursorPosition = myInput.selectionStart;
        const inputText = myInput.value;
        const textBeforeCursor = inputText.substring(0, cursorPosition);

        // Create a temporary span to measure text width
        const tempSpan = document.createElement('span');
        tempSpan.style.visibility = 'hidden';
        tempSpan.style.position = 'absolute';
        tempSpan.style.whiteSpace = 'pre'; // Preserve whitespace
        tempSpan.style.font = getComputedStyle(myInput).font; // Match input font
        tempSpan.textContent = textBeforeCursor;
        document.body.appendChild(tempSpan);

        const textWidth = tempSpan.offsetWidth;
        document.body.removeChild(tempSpan);

        // Position the anchor
        cursorAnchor.style.left = `${textWidth + myInput.offsetLeft + 5}px`; // Add input's left offset and padding
  }

  // Initial positioning
  updateCursorAnchor();
</script>

  </body>
</html>